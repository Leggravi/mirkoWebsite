<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>
  Über diese Website & Offline-Nutzung | Mirko in Brasilien
</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="/assets/css/style.css">

<link rel="icon" href="/assets/favicon.svg" type="image/svg+xml">
<!-- Fallback für alte Browser -->
<link rel="alternate icon" href="/assets/favicon.ico" type="image/x-icon">

<link rel="manifest" href="/manifest.webmanifest">
<link rel="manifest" href="/manifest.webmanifest">

<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/service-worker.js')
      .then(reg => console.log("SW registered:", reg.scope))
      .catch(err => console.error("SW registration failed:", err));
  }
</script>

<meta name="theme-color" content="#1fa2ff">
  <script>
    function switchTheme(theme) {
      document.body.setAttribute('data-theme', theme);
      localStorage.setItem('theme', theme);
    }

    window.onload = () => {
      const saved = localStorage.getItem('theme');
      if (saved) {
        document.body.setAttribute('data-theme', saved);
      } else {
        document.body.setAttribute('data-theme', 'light'); // Standard-Theme setzen
      }
    }
  </script>
  
</head>
<body>
  <div class="topbar">
    <div class="topbar-nav">
      <a href="/">🏠</a>
      <a href="/blog/">✍️</a>
    </div>
    <div class="topbar-themes theme-switcher" role="group" aria-label="Theme Switcher">
      <button title="Light" onclick="switchTheme('light')" aria-label="Light"><span>☀️</span></button>
      <button title="Dark" onclick="switchTheme('dark')" aria-label="Dark"><span>🌑</span></button>
      <button title="Blue" onclick="switchTheme('blue')" aria-label="Blue"><span>🔵</span></button>
      <button title="Forest" onclick="switchTheme('forest')" aria-label="Forest"><span>🌲</span></button>
      <button title="Game" onclick="switchTheme('game')" aria-label="Game"><span>🕹️</span></button>
    </div>
  </div>
  <div class="wrapper">
    <aside class="sidebar">
      <img src="/assets/img/mirko.jpg" alt="Mirko" class="profile-img">
      <h2>Navigation</h2>
      <ul>
        <li><a href="/">🏠 Start</a></li>
        <li><a href="/blog/">✍️ Blog</a></li>
      </ul>

      <h3 style="margin-top:2em;">Theme wechseln</h3>
      <div class="theme-switcher" role="group" aria-label="Theme Switcher">
        <button title="Light" onclick="switchTheme('light')" aria-label="Light"><span>☀️</span></button>
        <button title="Dark" onclick="switchTheme('dark')" aria-label="Dark"><span>🌑</span></button>
        <button title="Blue" onclick="switchTheme('blue')" aria-label="Blue"><span>🔵</span></button>
        <button title="Forest" onclick="switchTheme('forest')" aria-label="Forest"><span>🌲</span></button>
        <button title="Game" onclick="switchTheme('game')" aria-label="Game"><span>🕹️</span></button>
      </div>
    </aside>

    <main class="content">
      <h1>Über diese Website</h1>
<p>Diese Website kann als App installiert und offline verwendet werden.<br>
Damit das funktioniert, musst du die Seite einmal mit Internet besuchen.<br>
Danach werden die wichtigsten Seiten und Bilder automatisch gespeichert.</p>

<h2>Offline-Fehlermeldung</h2>
<p>Wenn du eine Seite besuchst, die noch nicht gespeichert wurde, zeigt dein Browser eine Standard-Offline-Meldung.<br>
Das ist bei GitHub Pages leider nicht anders möglich.</p>

<h2>Cache leeren</h2>
<p>Du kannst den Cache jederzeit über den Button <b>Cache leeren</b> im Footer löschen.<br>
Danach werden die Seiten beim nächsten Besuch neu gespeichert.</p>

<div id="installPrompt" style="display:none; text-align:center; margin:2em 0; border:2px solid #1fa2ff; border-radius:1em; padding:1em; background:#e0f7fa;">
  <h2>App installieren</h2>
  <p>Du kannst diese Website als App installieren!<br>
  Tippe unten auf „Installieren“.</p>
  <button id="installBtn" style="font-size:1.2em; padding:0.5em 2em;">Installieren</button>
</div>

<footer>
  <p>© 2364 qwertzuiopü</p>
  <p>Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> and GitHub Pages</p>
  <button onclick="clearCache()">Cache leeren</button>
</footer>

<script>
function clearCache() {
  if ('serviceWorker' in navigator && navigator.serviceWorker.controller) {
    navigator.serviceWorker.controller.postMessage('clear-cache');
    alert('Cache wurde geleert! Seite wird neu geladen.');
    window.location.reload();
  }
}

let deferredPrompt;
window.addEventListener('beforeinstallprompt', (e) => {
  e.preventDefault();
  deferredPrompt = e;
  document.getElementById('installPrompt').style.display = 'block';
});
document.getElementById('installBtn').onclick = function() {
  if (deferredPrompt) {
    deferredPrompt.prompt();
    deferredPrompt.userChoice.then(() => {
      document.getElementById('installPrompt').style.display = 'none';
      deferredPrompt = null;
    });
  }
};
</script>
    </main>
    <div class="toc">
      <h3>Inhalt</h3>
      <ul id="toc-list"></ul>
    </div>
  </div>

  <script>
  // NUR Überschriften aus dem Content-Bereich für den TOC verwenden!
  const toc = document.getElementById("toc-list");
  const content = document.querySelector(".content");
  const headers = Array.from(content.querySelectorAll("h2, h3"));
  let h2Map = {};

  headers.forEach(el => {
    const id = el.id || el.textContent.trim().toLowerCase().replace(/\s+/g, "-");
    el.id = id;
    if (el.tagName === "H2") {
      const li = document.createElement("li");
      li.innerHTML = `<a href="#${id}">${el.textContent}</a>`;
      toc.appendChild(li);
      h2Map[id] = li;
    } else if (el.tagName === "H3") {
      // Finde das vorherige H2
      const prevH2 = headers.slice(0, headers.indexOf(el)).reverse().find(h => h.tagName === "H2");
      if (prevH2) {
        const h2Id = prevH2.id;
        const h2Li = h2Map[h2Id];
        let sublist = h2Li.querySelector('.toc-sublist');
        if (!sublist) {
          sublist = document.createElement('ul');
          sublist.className = 'toc-sublist';
          h2Li.appendChild(sublist);
          // Toggle-Button nur einmal pro H2
          const toggle = document.createElement('span');
          toggle.className = 'toc-toggle';
          toggle.textContent = '▸';
          toggle.onclick = () => {
            h2Li.classList.toggle('open');
            toggle.textContent = h2Li.classList.contains('open') ? '▾' : '▸';
          };
          h2Li.insertBefore(toggle, h2Li.firstChild);
        }
        const subli = document.createElement("li");
        subli.innerHTML = `<a href="#${id}">↳ ${el.textContent}</a>`;
        sublist.appendChild(subli);
      }
    }
  });

  function markActiveTOC() {
    let activeId = null;
    headers.forEach(el => {
      const rect = el.getBoundingClientRect();
      if (rect.top < 120) activeId = el.id;
    });
    document.querySelectorAll('#toc-list a').forEach(a => {
      a.parentElement.classList.toggle('active', a.getAttribute('href').slice(1) === activeId);
    });
    // Öffne die aktuelle H2-Gruppe
    document.querySelectorAll('#toc-list li').forEach(li => {
      if (li.querySelector('.active')) li.classList.add('open');
      else li.classList.remove('open');
      const toggle = li.querySelector('.toc-toggle');
      if (toggle) toggle.textContent = li.classList.contains('open') ? '▾' : '▸';
    });
  }
  window.addEventListener('scroll', markActiveTOC);
  markActiveTOC();
  </script>
  <script>
  const originalTitle = document.title;
  let timeout;

  window.addEventListener('blur', () => {
    timeout = setTimeout(() => {
      document.title = "👋 Vermisst du mich?";
    }, 5000);
  });

  window.addEventListener('focus', () => {
    clearTimeout(timeout);
    document.title = originalTitle;
  });
</script>



<!--<button onclick="updateCache()">Cache erneuern</button>
<script>
  function updateCache() {
    if ('serviceWorker' in navigator && navigator.serviceWorker.controller) {
      navigator.serviceWorker.getRegistrations().then(regs => {
        for (let reg of regs) {
          reg.unregister().then(() => {
            window.location.reload();
          });
        }
      });
    }
  }
</script>-->


  <footer>
    <p>© 2364 qwertzuiopü</p>
    <p>Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> and GitHub Pages</p>
    <button onclick="clearCache()">Cache leeren</button>
  </footer>
  <script>
function clearCache() {
  if ('serviceWorker' in navigator && navigator.serviceWorker.controller) {
    navigator.serviceWorker.controller.postMessage('clear-cache');
    alert('Cache wurde geleert! Seite wird neu geladen.');
    window.location.reload();
  }
}
</script>
  <div style="text-align:center; margin:2em 0;">
    <a href="/about/">ℹ️ Mehr Infos & Offline-Hilfe</a>
  </div>
</body>
</html>

