<!DOCTYPE html>
<html lang="de">
<head>
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Status | Mirko in Brasilien</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Status" />
<meta name="author" content="Leggravi" />
<meta property="og:locale" content="de_DE" />
<meta name="description" content="Mirko in Brasilien - Ein Blog √ºber meine Erfahrungen und Erlebnisse w√§hrend meines Kurzzeiteinsatzes in der Missionsstation Alves de Barros in Brasilien." />
<meta property="og:description" content="Mirko in Brasilien - Ein Blog √ºber meine Erfahrungen und Erlebnisse w√§hrend meines Kurzzeiteinsatzes in der Missionsstation Alves de Barros in Brasilien." />
<link rel="canonical" href="http://localhost:4000/status/" />
<meta property="og:url" content="http://localhost:4000/status/" />
<meta property="og:site_name" content="Mirko in Brasilien" />
<meta property="og:image" content="http://localhost:4000/assets/img/seo.jpg" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/img/seo.jpg" />
<meta property="twitter:title" content="Status" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Leggravi"},"description":"Mirko in Brasilien - Ein Blog √ºber meine Erfahrungen und Erlebnisse w√§hrend meines Kurzzeiteinsatzes in der Missionsstation Alves de Barros in Brasilien.","headline":"Status","image":"http://localhost:4000/assets/img/seo.jpg","url":"http://localhost:4000/status/"}</script>
<!-- End Jekyll SEO tag -->


  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XNR3TD2Z94"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XNR3TD2Z94');
</script>
  
  <meta charset="UTF-8">
  <title>
  Status | Mirko in Brasilien
</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  

  <meta name="theme-color" content="#1fa2ff">
 <script>
  function switchTheme(theme) {
    document.body.setAttribute('data-theme', theme);
    localStorage.setItem('theme', theme);
    if (window.handleStarfieldTheme) handleStarfieldTheme();
    if (window.handlePollenTheme) handlePollenTheme();
  }

  window.addEventListener('DOMContentLoaded', () => {
    const saved = localStorage.getItem('theme');
    if (saved) {
      document.body.setAttribute('data-theme', saved);
    } else {
      document.body.setAttribute('data-theme', 'light');
    }
    if (window.handleStarfieldTheme) handleStarfieldTheme();
    if (window.handlePollenTheme) handlePollenTheme();
  });
</script>

  <link rel="stylesheet" href="/assets/css/style.css">

<link rel="icon" href="/assets/favicon.svg" type="image/svg+xml">
<!-- Fallback f√ºr alte Browser -->
<link rel="alternate icon" href="/assets/favicon.ico" type="image/x-icon">

<link rel="manifest" href="/manifest.json">

<!--<script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
<script>
  window.OneSignalDeferred = window.OneSignalDeferred || [];
  OneSignalDeferred.push(async function(OneSignal) {
    await OneSignal.init({
      appId: "dbff754e-f042-45ca-a0a1-ccfb8ed9cf4d",
      safari_web_id: "web.onesignal.auto.514888af-c9d7-482b-90d4-9de98d872128",
      notifyButton: {
        enable: true,
      },
      allowLocalhostAsSecureOrigin: true,
    });
  });
</script> -->


<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/service-worker.js')
      .then(reg => console.log("SW registered:", reg.scope))
      .catch(err => console.error("SW registration failed:", err));
  }
</script>



  
</head>
<body>
  <!-- STERNENHIMMEL CANVAS (nur f√ºr Game Theme sichtbar) -->
<canvas class="starfield-bg"></canvas>
<canvas class="forest-pollen"></canvas>
<div class="forest-rays"></div>
<div class="forest-rays2">
  <div class="ray ray1"></div>
  <div class="ray ray2"></div>
  <div class="ray ray3"></div>
  <div class="ray ray4"></div>
</div>


  <div class="topbar">
    <div class="topbar-nav">
      <a href="/">üè†</a>
      <a href="/blog/">‚úçÔ∏è</a>
      <a href="/status/">üì∑</a>
    </div>
    <div class="topbar-themes theme-switcher" role="group" aria-label="Theme Switcher">
      <button title="Light" onclick="switchTheme('light')" aria-label="Light"><span>‚òÄÔ∏è</span></button>
      <button title="Dark" onclick="switchTheme('dark')" aria-label="Dark"><span>üåë</span></button>
      <button title="Blue" onclick="switchTheme('blue')" aria-label="Blue"><span>üîµ</span></button>
      <button title="Forest" onclick="switchTheme('forest')" aria-label="Forest"><span>üå≤</span></button>
      <button title="Game" onclick="switchTheme('game')" aria-label="Game"><span>üïπÔ∏è</span></button>
    </div>
  </div>
  <g class="wrapper">
    <aside class="sidebar">
      <img src="/assets/img/mirko.jpg" alt="Mirko" class="profile-img">
      <h2>Navigation</h2>
      <ul>
        <li><a href="/">üè† Start</a></li>
        <li><a href="/blog/">‚úçÔ∏è Blog</a></li>
        <li><a href="/status/">üì∑ Status</a></li>
      </ul>

      <h3 style="margin-top:2em;">Thema wechseln</h3>
      <div class="theme-switcher" role="group" aria-label="Theme Switcher">
        <button title="Light" onclick="switchTheme('light')" aria-label="Light"><span>‚òÄÔ∏è</span></button>
        <button title="Dark" onclick="switchTheme('dark')" aria-label="Dark"><span>üåë</span></button>
        <button title="Blue" onclick="switchTheme('blue')" aria-label="Blue"><span>üîµ</span></button>
        <button title="Forest" onclick="switchTheme('forest')" aria-label="Forest"><span>üå≤</span></button>
        <button title="Game" onclick="switchTheme('game')" aria-label="Game"><span>üïπÔ∏è</span></button>
      </div>
      <div style="height:80px;"></div> <!-- Abstandshalter -->
      <p></p>

    </aside>

    <main class="content">
      <h1>Status ‚Äî Bilder√ºbersicht</h1>
<div id="image-list">Lade Bilder‚Ä¶</div>
<script>
// ----------------------------------------------------
// BILDER + VIDEOS SAMMELN (ohne Endung anzeigen)
// ----------------------------------------------------
var FILES = [


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
    {
      url: "/assets/img/AbiEinzug.jpg",
      name: "AbiEinzug",
      ext: ".jpg"
    }
    
  

  
    ,
    {
      url: "/assets/img/Arb1.jpg",
      name: "Arb1",
      ext: ".jpg"
    }
    
  

  
    ,
    {
      url: "/assets/img/Banana.jpg",
      name: "Banana",
      ext: ".jpg"
    }
    
  

  
    ,
    {
      url: "/assets/img/Gottesdienst.jpg",
      name: "Gottesdienst",
      ext: ".jpg"
    }
    
  

  
    ,
    {
      url: "/assets/img/Gulasch.jpg",
      name: "Gulasch",
      ext: ".jpg"
    }
    
  

  
    ,
    {
      url: "/assets/img/Vorbereitungsseminar.jpeg",
      name: "Vorbereitungsseminar",
      ext: ".jpeg"
    }
    
  

  
    ,
    {
      url: "/assets/img/dipm-logo.png",
      name: "dipm-logo",
      ext: ".png"
    }
    
  

  
    ,
    {
      url: "/assets/img/flagge.png",
      name: "flagge",
      ext: ".png"
    }
    
  

  
    ,
    {
      url: "/assets/img/flugfenster.jpg",
      name: "flugfenster",
      ext: ".jpg"
    }
    
  

  
    ,
    {
      url: "/assets/img/icon-192.png",
      name: "icon-192",
      ext: ".png"
    }
    
  

  
    ,
    {
      url: "/assets/img/icon-512.png",
      name: "icon-512",
      ext: ".png"
    }
    
  

  
    ,
    {
      url: "/assets/img/mirko.jpg",
      name: "mirko",
      ext: ".jpg"
    }
    
  

  
    ,
    {
      url: "/assets/img/mirkoalt.jpg",
      name: "mirkoalt",
      ext: ".jpg"
    }
    
  

  
    ,
    {
      url: "/assets/img/monat1/Fest.mp4",
      name: "Fest",
      ext: ".mp4"
    }
    
  

  
    ,
    {
      url: "/assets/img/monat1/Kurzzeitler.jpg",
      name: "Kurzzeitler",
      ext: ".jpg"
    }
    
  

  
    ,
    {
      url: "/assets/img/monat1/arbeit2.jpg",
      name: "arbeit2",
      ext: ".jpg"
    }
    
  

  

  
    ,
    {
      url: "/assets/img/monat1/ausblick.jpg",
      name: "ausblick",
      ext: ".jpg"
    }
    
  

  
    ,
    {
      url: "/assets/img/monat1/autofahren.mp4",
      name: "autofahren",
      ext: ".mp4"
    }
    
  

  
    ,
    {
      url: "/assets/img/monat1/gregor.mp4",
      name: "gregor",
      ext: ".mp4"
    }
    
  

  
    ,
    {
      url: "/assets/img/monat1/herz1.jpg",
      name: "herz1",
      ext: ".jpg"
    }
    
  

  
    ,
    {
      url: "/assets/img/monat1/herz2.jpg",
      name: "herz2",
      ext: ".jpg"
    }
    
  

  
    ,
    {
      url: "/assets/img/monat1/ich.jpg",
      name: "ich",
      ext: ".jpg"
    }
    
  

  
    ,
    {
      url: "/assets/img/monat1/neue%20H%C3%BCtte.jpeg",
      name: "neue H√ºtte",
      ext: ".jpeg"
    }
    
  

  
    ,
    {
      url: "/assets/img/monat1/pizza.jpg",
      name: "pizza",
      ext: ".jpg"
    }
    
  

  

  
    ,
    {
      url: "/assets/img/seo.jpg",
      name: "seo",
      ext: ".jpg"
    }
    
  

  
    ,
    {
      url: "/assets/img/spitze.jpg",
      name: "spitze",
      ext: ".jpg"
    }
    
  

  
    ,
    {
      url: "/assets/img/tmp/Banana.jpg",
      name: "Banana",
      ext: ".jpg"
    }
    
  

  
    ,
    {
      url: "/assets/img/tmp/IMG_20251013_100002.jpg",
      name: "IMG_20251013_100002",
      ext: ".jpg"
    }
    
  

  
    ,
    {
      url: "/assets/img/tmp/IMG_20251013_133327.jpg",
      name: "IMG_20251013_133327",
      ext: ".jpg"
    }
    
  

  
    ,
    {
      url: "/assets/img/tmp/IMG_20251020_175528.jpg",
      name: "IMG_20251020_175528",
      ext: ".jpg"
    }
    
  

  
    ,
    {
      url: "/assets/img/tmp/Vorbereitungsseminar%20copy.jpeg",
      name: "Vorbereitungsseminar copy",
      ext: ".jpeg"
    }
    
  

  
    ,
    {
      url: "/assets/img/tmp/WhatsApp%20Image%202025-10-12%20at%2022.44.24.jpeg",
      name: "WhatsApp Image 2025-10-12 at 22",
      ext: ".jpeg"
    }
    
  

  
    ,
    {
      url: "/assets/img/z%C3%A4hneputzen.png",
      name: "z√§hneputzen",
      ext: ".png"
    }
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

];
  
// ----------------------------------------------------
// HILFSFUNKTIONEN
// ----------------------------------------------------
function pad(n){ return n<10 ? '0'+n : ''+n; }
function formatGerman(d){
  if(!d) return "Kein Datum";
  return `${pad(d.getDate())}.${pad(d.getMonth()+1)}.${(d.getFullYear()+"").slice(-2)} ${pad(d.getHours())}:${pad(d.getMinutes())}`;
}

async function probeLastModified(url){
  try{
    const res = await fetch(url, {method:"HEAD"});
    const lm = res.headers.get("last-modified");
    return lm ? new Date(lm) : null;
  }catch{
    return null;
  }
}

// ----------------------------------------------------
// EXIF f√ºr Bilder
// ----------------------------------------------------
async function getExifDate(url){
  try{
    const res = await fetch(url);
    const buffer = await res.arrayBuffer();
    const tags = ExifReader.load(buffer);

    const candidates = [
      "DateTimeOriginal",
      "CreateDate",
      "DateTimeDigitized",
      "ModifyDate",
      "DateTime"
    ];

    for(const c of candidates){
      if(tags[c] && tags[c].description){
        const clean = tags[c].description.replace(/^(\d{4}):(\d{2}):/, "$1-$2-");
        const d = new Date(clean);
        if(!isNaN(d)) return d;
      }
    }
  }catch{}
  return null;
}

// ----------------------------------------------------
// DATUM HERAUSFINDEN (Bild ‚Üí EXIF, Video ‚Üí Modified)
// ----------------------------------------------------
async function getFileDate(file){
  const url = file.url;

  // Try EXIF only for images
  if(file.ext !== '.mp4' && file.ext !== '.mov' && file.ext !== '.webm'){
    const exif = await getExifDate(url);
    if(exif) return exif;
  }

  // Fallback: server last-modified
  return await probeLastModified(url);
}

// ----------------------------------------------------
// GRUPPIERUNG
// ----------------------------------------------------
function groupFor(date){
  if(!date) return "Ohne Datum";

  const now = new Date();
  const oneDay = 24*60*60*1000;

  if(date.toDateString() === now.toDateString()) return "Heute";

  const yesterday = new Date(now.getFullYear(), now.getMonth(), now.getDate()-1);
  if(date.toDateString() === yesterday.toDateString()) return "Gestern";

  if(date.getMonth() === now.getMonth() && date.getFullYear() === now.getFullYear())
    return "Dieser Monat";

  return `${pad(date.getMonth()+1)}/${date.getFullYear()}`;
}

// ----------------------------------------------------
// OVERLAY (gro√ü anzeigen)
// ----------------------------------------------------
function createOverlay(){
  const overlay = document.createElement("div");
  overlay.id = "viewer-overlay";
  overlay.style.cssText = `
    position: fixed; inset: 0;
    background: rgba(0,0,0,0.8);
    display: none; justify-content: center; align-items: center;
    z-index: 9999; padding: 20px;
  `;
  overlay.addEventListener("click", ()=> overlay.style.display = "none");

  const content = document.createElement("div");
  content.id = "viewer-content";
  content.style.maxWidth = "90%";
  content.style.maxHeight = "90%";

  overlay.appendChild(content);
  document.body.appendChild(overlay);
}

function openViewer(file){
  const overlay = document.getElementById("viewer-overlay");
  const content = document.getElementById("viewer-content");

  content.innerHTML = "";

  if(file.ext === ".mp4" || file.ext === ".mov" || file.ext === ".webm"){
    const v = document.createElement("video");
    v.src = file.url;
    v.controls = true;
    v.autoplay = true;
    v.style.maxWidth = "100%";
    v.style.maxHeight = "90vh";
    content.appendChild(v);
  } else {
    const img = document.createElement("img");
    img.src = file.url;
    img.style.maxWidth = "100%";
    img.style.maxHeight = "90vh";
    content.appendChild(img);
  }

  overlay.style.display = "flex";
}

// ----------------------------------------------------
// HAUPTRENDER
// ----------------------------------------------------
async function render(){
  createOverlay();

  const list = document.getElementById("image-list");
  list.innerHTML = "";

  const enriched = await Promise.all(
    FILES.map(async f => {
      const date = await getFileDate(f);
      return {...f, date};
    })
  );

  enriched.sort((a,b)=>{
    if(a.date && b.date) return b.date - a.date;
    if(a.date) return -1;
    if(b.date) return 1;
    return a.name.localeCompare(b.name);
  });

  const groups = {};
  enriched.forEach(f=>{
    const g = groupFor(f.date);
    if(!groups[g]) groups[g] = [];
    groups[g].push(f);
  });

  // Render
  for(const g in groups){
    const h = document.createElement("h2");
    h.textContent = g;
    h.style.marginTop = "2rem";
    list.appendChild(h);

    const grid = document.createElement("div");
    grid.style.display = "grid";
    grid.style.gridTemplateColumns = "repeat(auto-fill, minmax(200px,1fr))";
    grid.style.gap = "1rem";
    list.appendChild(grid);

    groups[g].forEach(file=>{
      const card = document.createElement("div");
      card.style.border = "1px solid #ddd";
      card.style.padding = "8px";
      card.style.borderRadius = "8px";
      card.style.cursor = "pointer";

      let preview;

      if(file.ext === ".mp4" || file.ext === ".mov" || file.ext === ".webm"){
        preview = document.createElement("video");
        preview.src = file.url;
        preview.muted = true;
        preview.style.height = "140px";
        preview.style.width = "100%";
        preview.style.objectFit = "cover";
      } else {
        preview = document.createElement("img");
        preview.src = file.url;
        preview.style.height = "140px";
        preview.style.width = "100%";
        preview.style.objectFit = "cover";
      }

      const name = document.createElement("div");
      name.textContent = file.name;
      name.style.fontSize = "0.85rem";

      const date = document.createElement("div");
      date.textContent = formatGerman(file.date);
      date.style.color = "#666";
      date.style.fontSize = "0.8rem";

      card.appendChild(preview);
      card.appendChild(name);
      card.appendChild(date);

      card.addEventListener("click", ()=> openViewer(file));

      grid.appendChild(card);
    });
  }
}

document.addEventListener("DOMContentLoaded", render);
</script>

    </main>
    <div class="toc">
      <h3>Inhalt</h3>
      <ul id="toc-list"></ul>
    </div>
  </g>

  
  <script>
  // NUR √úberschriften aus dem Content-Bereich f√ºr den TOC verwenden!
  const toc = document.getElementById("toc-list");
  const content = document.querySelector(".content");
  const headers = Array.from(content.querySelectorAll("h2, h3"));
  let h2Map = {};

  headers.forEach(el => {
    const id = el.id || el.textContent.trim().toLowerCase().replace(/\s+/g, "-");
    el.id = id;
    if (el.tagName === "H2") {
      const li = document.createElement("li");
      li.innerHTML = `<a href="#${id}">${el.textContent}</a>`;
      toc.appendChild(li);
      h2Map[id] = li;
    } else if (el.tagName === "H3") {
      // Finde das vorherige H2
      const prevH2 = headers.slice(0, headers.indexOf(el)).reverse().find(h => h.tagName === "H2");
      if (prevH2) {
        const h2Id = prevH2.id;
        const h2Li = h2Map[h2Id];
        let sublist = h2Li.querySelector('.toc-sublist');
        if (!sublist) {
          sublist = document.createElement('ul');
          sublist.className = 'toc-sublist';
          h2Li.appendChild(sublist);
          // Toggle-Button nur einmal pro H2
          const toggle = document.createElement('span');
          toggle.className = 'toc-toggle';
          toggle.textContent = '‚ñ∏';
          toggle.onclick = () => {
            h2Li.classList.toggle('open');
            toggle.textContent = h2Li.classList.contains('open') ? '‚ñæ' : '‚ñ∏';
          };
          h2Li.insertBefore(toggle, h2Li.firstChild);
        }
        const subli = document.createElement("li");
        subli.innerHTML = `<a href="#${id}">‚Ü≥ ${el.textContent}</a>`;
        sublist.appendChild(subli);
      }
    }
  });

  function markActiveTOC() {
    let activeId = null;
    headers.forEach(el => {
      const rect = el.getBoundingClientRect();
      if (rect.top < 120) activeId = el.id;
    });
    document.querySelectorAll('#toc-list a').forEach(a => {
      a.parentElement.classList.toggle('active', a.getAttribute('href').slice(1) === activeId);
    });
    // √ñffne die aktuelle H2-Gruppe
    document.querySelectorAll('#toc-list li').forEach(li => {
      if (li.querySelector('.active')) li.classList.add('open');
      else li.classList.remove('open');
      const toggle = li.querySelector('.toc-toggle');
      if (toggle) toggle.textContent = li.classList.contains('open') ? '‚ñæ' : '‚ñ∏';
    });
  }
  window.addEventListener('scroll', markActiveTOC);
  markActiveTOC();
  </script>
  <script>
  const originalTitle = document.title;
  let timeout;

  window.addEventListener('blur', () => {
    timeout = setTimeout(() => {
      document.title = "üëã Vermisst du mich?";
    }, 600000);
  });

  window.addEventListener('focus', () => {
    clearTimeout(timeout);
    document.title = originalTitle;
  });
</script>



<!--<button onclick="updateCache()">Cache erneuern</button>
<script>
  function updateCache() {
    if ('serviceWorker' in navigator && navigator.serviceWorker.controller) {
      navigator.serviceWorker.getRegistrations().then(regs => {
        for (let reg of regs) {
          reg.unregister().then(() => {
            window.location.reload();
          });
        }
      });
    }
  }
</script>-->


  <script>
function clearCache() {
  if ('serviceWorker' in navigator && navigator.serviceWorker.controller) {
    navigator.serviceWorker.controller.postMessage('clear-cache');
    alert('Cache wurde geleert! Seite wird neu geladen.');
    window.location.reload();
  }
}
</script>
  <div style="text-align:center; margin:2em 0;">
    <a href="/about/">‚ÑπÔ∏è Mehr Infos</a> |
    <a href="/spenden/">üí∏ Spenden</a> 
  </div>

<script src="/assets/js/notifications.js"></script>
<script>
function getCookie(name) {
  const match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));
  return match ? decodeURIComponent(match[2]) : "";
}
function setCookie(name, value, days) {
  const expires = new Date(Date.now() + days*864e5).toUTCString();
  document.cookie = name + "=" + encodeURIComponent(value) + ";path=/;expires=" + expires;
}

// Typen mit Farbe und Dauer
const typeStyles = {
  info:    { color: "#1fa2ff", duration: 0 },
  success: { color: "#4caf50", duration: 4000 },
  warning: { color: "#ff9800", duration: 6000 },
  error:   { color: "#e53935", duration: 8000 }
};

const seen = getCookie("seenNotifications") ? getCookie("seenNotifications").split(",") : [];
const allNotes = window.NOTIFICATIONS || [];
const newNotes = allNotes.filter(n => !seen.includes(n.id));

// Zeige alle neuen Nachrichten als Banner untereinander
newNotes.forEach(n => {
  const style = typeStyles[n.type] || typeStyles.info;
  const div = document.createElement("div");
  div.className = "notification-banner";
  div.innerHTML = `<span>${n.message}</span> <a href="/${n.url}">Ansehen</a> <button onclick="this.parentElement.remove()">√ó</button>`;
  div.style = `
    position:fixed;left:50%;transform:translateX(-50%);
    background:${style.color};color:#111;font-weight:bold;
    padding:1em 2em;border-radius:1em;z-index:9999;
    box-shadow:0 2px 8px #0002;
    font-family:sans-serif;
    bottom:${2 + 4 * Array.from(document.querySelectorAll('.notification-banner')).length}em;
    margin-bottom:1em;
  `;
  document.body.appendChild(div);
  if (style.duration > 0) {
    setTimeout(() => div.remove(), style.duration);
  }
});

// Nach Anzeige als gesehen speichern
if (newNotes.length) {
  setCookie("seenNotifications", seen.concat(newNotes.map(n=>n.id)).join(","), 365);
}
</script>
<script>
// --- STERNENHIMMEL ANIMATION MIT PARALLAX UND BLINKEN ---

let starfieldAnimationId = null;
let starfieldActive = false;
let lastScrollY = window.scrollY;

function startStarfield() {
  const canvas = document.querySelector('.starfield-bg');
  if (!canvas) return;
  const ctx = canvas.getContext('2d');
  let w = window.innerWidth, h = window.innerHeight;
  canvas.width = w;
  canvas.height = h;

  // Parallax-Faktor (0.3 = 30% der Scrollgeschwindigkeit)
  const PARALLAX = 0.3;

  // Sterne erzeugen
  const STAR_COUNT = 120;
  function newStar() {
    return {
      x: Math.random() * w,
      y: Math.random() * h,
      r: Math.random() * 1.2 + 0.3,
      blink: Math.random() * Math.PI * .1,
      speed: Math.random() * 0.2 + 0.15,
      life: Math.random() * 1.5 + 0.5, // Sekunden sichtbar
      age: 0
    };
  }
  let stars = Array.from({length: STAR_COUNT}, newStar);

  let lastTime = performance.now();

  function draw(now) {
    if (!starfieldActive) return;
    const dt = (now - lastTime) / 1000;
    lastTime = now;

    ctx.clearRect(0, 0, w, h);

    // Parallax-Offset berechnen
    const scrollY = window.scrollY;
    const parallaxOffset = scrollY * PARALLAX;

    for (let i = 0; i < stars.length; ++i) {
      let s = stars[i];
      s.age += dt;
      s.blink += s.speed * 0.25 + Math.random() * .3;
      // Wenn Lebensdauer vorbei: neuen Stern erzeugen
      if (s.age > s.life) {
        stars[i] = newStar();
        stars[i].y += parallaxOffset; // damit neue Sterne nicht "springen"
        continue;
      }
      // Alpha: schnelles Blinken
      const blinkAlpha = 0.3 + 0.7 * Math.abs(Math.sin(s.blink * 2));
      // Fade-in/out am Lebensanfang/-ende
      let fade = 1;
      if (s.age < 0.2) fade = s.age / 0.2;
      if (s.life - s.age < 0.2) fade = (s.life - s.age) / 0.2;
      const alpha = blinkAlpha * Math.max(0, fade);

      ctx.beginPath();
      ctx.arc(s.x, s.y - parallaxOffset, s.r, 0, 2 * Math.PI);
      ctx.fillStyle = `rgba(255,255,255,${alpha})`;
      ctx.shadowColor = "#0ff";
      ctx.shadowBlur = 8 * alpha;
      ctx.fill();
      ctx.shadowBlur = 0;
    }
    starfieldAnimationId = requestAnimationFrame(draw);
  }

  starfieldActive = true;
  lastTime = performance.now();
  draw(lastTime);

  function resize() {
    w = window.innerWidth;
    h = window.innerHeight;
    canvas.width = w;
    canvas.height = h;
    // Sterne neu verteilen
    stars = Array.from({length: STAR_COUNT}, newStar);
  }
  window.addEventListener('resize', resize);

  window.addEventListener('scroll', () => {
    // Kein Neuzeichnen n√∂tig, da draw() sowieso l√§uft und scrollY abfragt
  });
}

function stopStarfield() {
  starfieldActive = false;
  if (starfieldAnimationId) {
    cancelAnimationFrame(starfieldAnimationId);
    starfieldAnimationId = null;
  }
  const canvas = document.querySelector('.starfield-bg');
  if (canvas) {
    const ctx = canvas.getContext('2d');
    ctx && ctx.clearRect(0, 0, canvas.width, canvas.height);
  }
}

function handleStarfieldTheme() {
  const body = document.body;
  const canvas = document.querySelector('.starfield-bg');
  if (body.getAttribute('data-theme') === 'game') {
    canvas && (canvas.style.display = '');
    stopStarfield(); // Falls noch eine alte Animation l√§uft
    startStarfield();
  } else {
    stopStarfield();
    canvas && (canvas.style.display = 'none');
  }
}

// Theme-Wechsel erkennen (auch bei Button-Klicks)
document.addEventListener('DOMContentLoaded', handleStarfieldTheme);
const origSwitchTheme = window.switchTheme;
window.switchTheme = function(theme) {
  origSwitchTheme(theme);
  setTimeout(handleStarfieldTheme, 10); // Nach Attribut-Update
};
</script>
<script>
// --- POLLENPARTIKEL F√úR FOREST THEME ---
let pollenAnimId = null;
let pollenActive = false;

function startPollen() {
  const canvas = document.querySelector('.forest-pollen');
  if (!canvas) return;
  const ctx = canvas.getContext('2d');
  let w = window.innerWidth, h = window.innerHeight;
  canvas.width = w; canvas.height = h;

  const PARALLAX = .5;
  const COUNT = 40;
  function newPollen() {
    return {
      x: Math.random()*w,
      y: Math.random()*h,
      r: Math.random()*3.5+0.5,
      dx: (Math.random()-0.5)*0.43,
      dy: Math.random()*0.38-0.13,
      alpha: Math.random()*0.3+0.2,
      life: Math.random()*2+3,
      age: 0
      
    };
  }
  let pollen = Array.from({length: COUNT}, newPollen);

  let lastTime = performance.now();

  function draw(now) {
    if (!pollenActive) return;
    const dt = (now - lastTime) / 1000;
    lastTime = now;

    ctx.clearRect(0,0,w,h);

    // Parallax-Offset
    const scrollY = window.scrollY;
    const parallaxOffset = scrollY * PARALLAX;

    for (let i = 0; i < pollen.length; ++i) {
      let p = pollen[i];
      p.age += dt;
      if (p.age > p.life) {
        pollen[i] = newPollen();
        pollen[i].y += parallaxOffset;
        continue;
      }
      // Fade-in/out
      let fade = 1;
      if (p.age < 1) fade = p.age ;
      if (p.life - p.age < 1) fade = (p.life - p.age) ;
      const alpha = p.alpha * Math.max(0, fade);

      ctx.beginPath();
      ctx.arc(p.x, p.y - parallaxOffset, p.r, 0, 2*Math.PI);
      ctx.fillStyle = `rgba(255,255,200,${alpha})`;
      ctx.shadowColor = "#fff";
      ctx.shadowBlur = 4;
      ctx.fill();
      ctx.shadowBlur = 0;
      p.x += p.dx; p.y += p.dy;
      //if (p.x<0) p.x=w; if (p.x>w) p.x=0;
      //if (p.y>h) { p.y=0; p.x=Math.random()*w; }
    }
    pollenAnimId = requestAnimationFrame(draw);
  }

  pollenActive = true;
  lastTime = performance.now();
  draw(lastTime);

  function resize() {
    w = window.innerWidth; h = window.innerHeight;
    canvas.width = w; canvas.height = h;
    pollen = Array.from({length: COUNT}, newPollen);
  }
  window.addEventListener('resize', resize);
}

function stopPollen() {
  pollenActive = false;
  if (pollenAnimId) cancelAnimationFrame(pollenAnimId);
  pollenAnimId = null;
  const canvas = document.querySelector('.forest-pollen');
  if (canvas) canvas.getContext('2d').clearRect(0,0,canvas.width,canvas.height);
}

function handlePollenTheme() {
  const body = document.body, canvas = document.querySelector('.forest-pollen');
  if (body.getAttribute('data-theme') === 'forest') {
    canvas && (canvas.style.display = '');
    stopPollen(); startPollen();
  } else {
    stopPollen(); canvas && (canvas.style.display = 'none');
  }
}

// Theme-Wechsel erkennen (wie bei Sternenhimmel)
document.querySelectorAll('a[href$="feed.xml"]').forEach(el => {
  el.href = "https://forms.gle/kDLjBrFRAX2mfBYA9"; // neuer Link
  el.textContent = "via E-mail";          // neuer Text
  el.target = "_blank";                             // optional: in neuem Tab √∂ffnen
});

</script>

</body>
</html>

