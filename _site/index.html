<!DOCTYPE html>
<html lang="de">
<head>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XNR3TD2Z94"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XNR3TD2Z94');
</script>
  
  <meta charset="UTF-8">
  <title>
  Willkommen | Mirko in Brasilien
</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  

  <meta name="theme-color" content="#1fa2ff">
 <script>
  function switchTheme(theme) {
    document.body.setAttribute('data-theme', theme);
    localStorage.setItem('theme', theme);
    if (window.handleStarfieldTheme) handleStarfieldTheme();
  }

  window.addEventListener('DOMContentLoaded', () => {
    const saved = localStorage.getItem('theme');
    if (saved) {
      document.body.setAttribute('data-theme', saved);
    } else {
      document.body.setAttribute('data-theme', 'light');
    }
    if (window.handleStarfieldTheme) handleStarfieldTheme();
  });
</script>

  <link rel="stylesheet" href="/assets/css/style.css">

<link rel="icon" href="/assets/favicon.svg" type="image/svg+xml">
<!-- Fallback für alte Browser -->
<link rel="alternate icon" href="/assets/favicon.ico" type="image/x-icon">

<link rel="manifest" href="/manifest.json">

<!--<script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
<script>
  window.OneSignalDeferred = window.OneSignalDeferred || [];
  OneSignalDeferred.push(async function(OneSignal) {
    await OneSignal.init({
      appId: "dbff754e-f042-45ca-a0a1-ccfb8ed9cf4d",
      safari_web_id: "web.onesignal.auto.514888af-c9d7-482b-90d4-9de98d872128",
      notifyButton: {
        enable: true,
      },
      allowLocalhostAsSecureOrigin: true,
    });
  });
</script> -->


<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/service-worker.js')
      .then(reg => console.log("SW registered:", reg.scope))
      .catch(err => console.error("SW registration failed:", err));
  }
</script>



  
</head>
<body>
  <!-- STERNENHIMMEL CANVAS (nur für Game Theme sichtbar) -->
<canvas class="starfield-bg"></canvas>
<!-- SONNENSTRAHLEN (nur für Forest Theme sichtbar) -->
<div class="forest-rays">
  <div class="ray ray1"></div>
  <div class="ray ray2"></div>
  <div class="ray ray3"></div>
  <div class="ray ray4"></div>
</div>
<div class="forest-fog"></div>

  <div class="topbar">
    <div class="topbar-nav">
      <a href="/">🏠</a>
      <a href="/blog/">✍️</a>
    </div>
    <div class="topbar-themes theme-switcher" role="group" aria-label="Theme Switcher">
      <button title="Light" onclick="switchTheme('light')" aria-label="Light"><span>☀️</span></button>
      <button title="Dark" onclick="switchTheme('dark')" aria-label="Dark"><span>🌑</span></button>
      <button title="Blue" onclick="switchTheme('blue')" aria-label="Blue"><span>🔵</span></button>
      <button title="Forest" onclick="switchTheme('forest')" aria-label="Forest"><span>🌲</span></button>
      <button title="Game" onclick="switchTheme('game')" aria-label="Game"><span>🕹️</span></button>
    </div>
  </div>
  <div class="wrapper">
    <aside class="sidebar">
      <img src="/assets/img/mirko.jpg" alt="Mirko" class="profile-img">
      <h2>Navigation</h2>
      <ul>
        <li><a href="/">🏠 Start</a></li>
        <li><a href="/blog/">✍️ Blog</a></li>
      </ul>

      <h3 style="margin-top:2em;">Thema wechseln</h3>
      <div class="theme-switcher" role="group" aria-label="Theme Switcher">
        <button title="Light" onclick="switchTheme('light')" aria-label="Light"><span>☀️</span></button>
        <button title="Dark" onclick="switchTheme('dark')" aria-label="Dark"><span>🌑</span></button>
        <button title="Blue" onclick="switchTheme('blue')" aria-label="Blue"><span>🔵</span></button>
        <button title="Forest" onclick="switchTheme('forest')" aria-label="Forest"><span>🌲</span></button>
        <button title="Game" onclick="switchTheme('game')" aria-label="Game"><span>🕹️</span></button>
      </div>
    </aside>

    <main class="content">
      <h1 id="willkommen-auf-mirkos-brasilien-blog">Willkommen auf Mirkos Brasilien-Blog</h1>

<p>Hier werde ich regelmäßig Rundbriefe und Eindrücke posten über meine Zeit in Brasilien</p>

<p>Im Oktober starte ich nach Brasilien. Dort werde ich auf einer Missionsstation die Missionare vor Ort praktisch unterstützen.</p>

<p>Auf meinem Blog teile ich meine Erlebnisse, Eindrücke und Gebetsanliegen. Schau gerne vorbei und begleite mich auf dieser Reise!</p>

<ul>
  <li>
    <p>👉 <a href="about/">Mehr über die Website</a></p>
  </li>
  <li>
    <p>👉 <a href="blog/">Blogbeiträge (✍️)</a></p>
  </li>
  <li>
    <p>👉 <a href="https://forms.gle/kDLjBrFRAX2mfBYA9">Für Updates anmelden</a></p>
  </li>
  <li>
    <p>👉 <a href="spenden/">Spenden</a></p>
  </li>
</ul>

    </main>
    <div class="toc">
      <h3>Inhalt</h3>
      <ul id="toc-list"></ul>
    </div>
  </div>

  
  <script>
  // NUR Überschriften aus dem Content-Bereich für den TOC verwenden!
  const toc = document.getElementById("toc-list");
  const content = document.querySelector(".content");
  const headers = Array.from(content.querySelectorAll("h2, h3"));
  let h2Map = {};

  headers.forEach(el => {
    const id = el.id || el.textContent.trim().toLowerCase().replace(/\s+/g, "-");
    el.id = id;
    if (el.tagName === "H2") {
      const li = document.createElement("li");
      li.innerHTML = `<a href="#${id}">${el.textContent}</a>`;
      toc.appendChild(li);
      h2Map[id] = li;
    } else if (el.tagName === "H3") {
      // Finde das vorherige H2
      const prevH2 = headers.slice(0, headers.indexOf(el)).reverse().find(h => h.tagName === "H2");
      if (prevH2) {
        const h2Id = prevH2.id;
        const h2Li = h2Map[h2Id];
        let sublist = h2Li.querySelector('.toc-sublist');
        if (!sublist) {
          sublist = document.createElement('ul');
          sublist.className = 'toc-sublist';
          h2Li.appendChild(sublist);
          // Toggle-Button nur einmal pro H2
          const toggle = document.createElement('span');
          toggle.className = 'toc-toggle';
          toggle.textContent = '▸';
          toggle.onclick = () => {
            h2Li.classList.toggle('open');
            toggle.textContent = h2Li.classList.contains('open') ? '▾' : '▸';
          };
          h2Li.insertBefore(toggle, h2Li.firstChild);
        }
        const subli = document.createElement("li");
        subli.innerHTML = `<a href="#${id}">↳ ${el.textContent}</a>`;
        sublist.appendChild(subli);
      }
    }
  });

  function markActiveTOC() {
    let activeId = null;
    headers.forEach(el => {
      const rect = el.getBoundingClientRect();
      if (rect.top < 120) activeId = el.id;
    });
    document.querySelectorAll('#toc-list a').forEach(a => {
      a.parentElement.classList.toggle('active', a.getAttribute('href').slice(1) === activeId);
    });
    // Öffne die aktuelle H2-Gruppe
    document.querySelectorAll('#toc-list li').forEach(li => {
      if (li.querySelector('.active')) li.classList.add('open');
      else li.classList.remove('open');
      const toggle = li.querySelector('.toc-toggle');
      if (toggle) toggle.textContent = li.classList.contains('open') ? '▾' : '▸';
    });
  }
  window.addEventListener('scroll', markActiveTOC);
  markActiveTOC();
  </script>
  <script>
  const originalTitle = document.title;
  let timeout;

  window.addEventListener('blur', () => {
    timeout = setTimeout(() => {
      document.title = "👋 Vermisst du mich?";
    }, 5000);
  });

  window.addEventListener('focus', () => {
    clearTimeout(timeout);
    document.title = originalTitle;
  });
</script>



<!--<button onclick="updateCache()">Cache erneuern</button>
<script>
  function updateCache() {
    if ('serviceWorker' in navigator && navigator.serviceWorker.controller) {
      navigator.serviceWorker.getRegistrations().then(regs => {
        for (let reg of regs) {
          reg.unregister().then(() => {
            window.location.reload();
          });
        }
      });
    }
  }
</script>-->


  <script>
function clearCache() {
  if ('serviceWorker' in navigator && navigator.serviceWorker.controller) {
    navigator.serviceWorker.controller.postMessage('clear-cache');
    alert('Cache wurde geleert! Seite wird neu geladen.');
    window.location.reload();
  }
}
</script>
  <div style="text-align:center; margin:2em 0;">
    <a href="/about/">ℹ️ Mehr Infos</a> |
    <a href="/notes/">🔔 Benachrichtigungen </a> |
    <a href="/spenden/">💸 Spenden</a> 
  </div>

<script src="/assets/js/notifications.js"></script>
<script>
function getCookie(name) {
  const match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));
  return match ? decodeURIComponent(match[2]) : "";
}
function setCookie(name, value, days) {
  const expires = new Date(Date.now() + days*864e5).toUTCString();
  document.cookie = name + "=" + encodeURIComponent(value) + ";path=/;expires=" + expires;
}

// Typen mit Farbe und Dauer
const typeStyles = {
  info:    { color: "#1fa2ff", duration: 0 },
  success: { color: "#4caf50", duration: 4000 },
  warning: { color: "#ff9800", duration: 6000 },
  error:   { color: "#e53935", duration: 8000 }
};

const seen = getCookie("seenNotifications") ? getCookie("seenNotifications").split(",") : [];
const allNotes = window.NOTIFICATIONS || [];
const newNotes = allNotes.filter(n => !seen.includes(n.id));

// Zeige alle neuen Nachrichten als Banner untereinander
newNotes.forEach(n => {
  const style = typeStyles[n.type] || typeStyles.info;
  const div = document.createElement("div");
  div.className = "notification-banner";
  div.innerHTML = `<span>${n.message}</span> <a href="${n.url}">Ansehen</a> <button onclick="this.parentElement.remove()">×</button>`;
  div.style = `
    position:fixed;left:50%;transform:translateX(-50%);
    background:${style.color};color:#111;font-weight:bold;
    padding:1em 2em;border-radius:1em;z-index:9999;
    box-shadow:0 2px 8px #0002;
    font-family:sans-serif;
    bottom:${2 + 4 * Array.from(document.querySelectorAll('.notification-banner')).length}em;
    margin-bottom:1em;
  `;
  document.body.appendChild(div);
  if (style.duration > 0) {
    setTimeout(() => div.remove(), style.duration);
  }
});

// Nach Anzeige als gesehen speichern
if (newNotes.length) {
  setCookie("seenNotifications", seen.concat(newNotes.map(n=>n.id)).join(","), 365);
}
</script>
<script>
// --- STERNENHIMMEL ANIMATION MIT PARALLAX UND BLINKEN ---

let starfieldAnimationId = null;
let starfieldActive = false;
let lastScrollY = window.scrollY;

function startStarfield() {
  const canvas = document.querySelector('.starfield-bg');
  if (!canvas) return;
  const ctx = canvas.getContext('2d');
  let w = window.innerWidth, h = window.innerHeight;
  canvas.width = w;
  canvas.height = h;

  // Parallax-Faktor (0.3 = 30% der Scrollgeschwindigkeit)
  const PARALLAX = 0.3;

  // Sterne erzeugen
  const STAR_COUNT = 120;
  function newStar() {
    return {
      x: Math.random() * w,
      y: Math.random() * h,
      r: Math.random() * 1.2 + 0.3,
      blink: Math.random() * Math.PI * .1,
      speed: Math.random() * 0.2 + 0.15,
      life: Math.random() * 1.5 + 0.5, // Sekunden sichtbar
      age: 0
    };
  }
  let stars = Array.from({length: STAR_COUNT}, newStar);

  let lastTime = performance.now();

  function draw(now) {
    if (!starfieldActive) return;
    const dt = (now - lastTime) / 1000;
    lastTime = now;

    ctx.clearRect(0, 0, w, h);

    // Parallax-Offset berechnen
    const scrollY = window.scrollY;
    const parallaxOffset = scrollY * PARALLAX;

    for (let i = 0; i < stars.length; ++i) {
      let s = stars[i];
      s.age += dt;
      s.blink += s.speed * 0.25 + Math.random() * .3;
      // Wenn Lebensdauer vorbei: neuen Stern erzeugen
      if (s.age > s.life) {
        stars[i] = newStar();
        stars[i].y += parallaxOffset; // damit neue Sterne nicht "springen"
        continue;
      }
      // Alpha: schnelles Blinken
      const blinkAlpha = 0.3 + 0.7 * Math.abs(Math.sin(s.blink * 2));
      // Fade-in/out am Lebensanfang/-ende
      let fade = 1;
      if (s.age < 0.2) fade = s.age / 0.2;
      if (s.life - s.age < 0.2) fade = (s.life - s.age) / 0.2;
      const alpha = blinkAlpha * Math.max(0, fade);

      ctx.beginPath();
      ctx.arc(s.x, s.y - parallaxOffset, s.r, 0, 2 * Math.PI);
      ctx.fillStyle = `rgba(255,255,255,${alpha})`;
      ctx.shadowColor = "#0ff";
      ctx.shadowBlur = 8 * alpha;
      ctx.fill();
      ctx.shadowBlur = 0;
    }
    starfieldAnimationId = requestAnimationFrame(draw);
  }

  starfieldActive = true;
  lastTime = performance.now();
  draw(lastTime);

  function resize() {
    w = window.innerWidth;
    h = window.innerHeight;
    canvas.width = w;
    canvas.height = h;
    // Sterne neu verteilen
    stars = Array.from({length: STAR_COUNT}, newStar);
  }
  window.addEventListener('resize', resize);

  window.addEventListener('scroll', () => {
    // Kein Neuzeichnen nötig, da draw() sowieso läuft und scrollY abfragt
  });
}

function stopStarfield() {
  starfieldActive = false;
  if (starfieldAnimationId) {
    cancelAnimationFrame(starfieldAnimationId);
    starfieldAnimationId = null;
  }
  const canvas = document.querySelector('.starfield-bg');
  if (canvas) {
    const ctx = canvas.getContext('2d');
    ctx && ctx.clearRect(0, 0, canvas.width, canvas.height);
  }
}

function handleStarfieldTheme() {
  const body = document.body;
  const canvas = document.querySelector('.starfield-bg');
  if (body.getAttribute('data-theme') === 'game') {
    canvas && (canvas.style.display = '');
    stopStarfield(); // Falls noch eine alte Animation läuft
    startStarfield();
  } else {
    stopStarfield();
    canvas && (canvas.style.display = 'none');
  }
}

// Theme-Wechsel erkennen (auch bei Button-Klicks)
document.addEventListener('DOMContentLoaded', handleStarfieldTheme);
const origSwitchTheme = window.switchTheme;
window.switchTheme = function(theme) {
  origSwitchTheme(theme);
  setTimeout(handleStarfieldTheme, 10); // Nach Attribut-Update
};
</script>
<!-- ...existing code... -->
<script>
(function() {
  const FOG_COUNT = 20;
  let fogs = [];
  let running = false;
  const fogContainer = document.querySelector('.forest-fog');

  function randomFogProps() {
    const vh = window.innerHeight;
    const vw = window.innerWidth;
    return {
      top: Math.random() * (vh * 0.7) + vh * 0.2, // 55-95vh
      left: vw + Math.random() * vw * 0.3, // Start rechts außerhalb
      width: Math.random() * 18 + 18, // 18vw - 36vw
      height: Math.random() * 8 + 8,  // 8vh - 16vh
      opacity: Math.random() * 0.18 + 0.42, // 0.12 - 0.3
      blur: Math.random() * 18 + 12, // 12px - 30px
      speed: Math.random() * 0.12 + 0.04 // 0.04 - 0.16 vw/ms
    };
  }

  function createFog() {
    const props = randomFogProps();
    const fog = document.createElement('div');
    fog.className = 'fog';
    fog.style.top = props.top + 'px';
    fog.style.left = props.left + 'px';
    fog.style.width = props.width + 'vw';
    fog.style.height = props.height + 'vh';
    fog.style.opacity = props.opacity;
    fog.style.filter = `blur(${props.blur}px)`;
    fog.dataset.speed = props.speed;
    fog.dataset.left = props.left;
    fogContainer.appendChild(fog);
    return fog;
  }

  function animateFogs(ts) {
    if (!running) return;
    const vw = window.innerWidth;
    fogs.forEach(fog => {
      let left = parseFloat(fog.dataset.left);
      left -= fog.dataset.speed * vw * 0.016; // 60fps: ca. 16ms/frame
      fog.dataset.left = left;
      fog.style.left = left + 'px';
      // Optional: leichtes Wabern
      fog.style.top = (parseFloat(fog.style.top) + Math.sin(left/80) * 0.2) + 'px';
      // Entfernen, wenn links raus
      if (left + fog.offsetWidth < -20) {
        fog.remove();
      }
    });
    // Entfernte fogs ersetzen
    fogs = fogs.filter(fog => fog.isConnected);
    while (fogs.length < FOG_COUNT) {
      fogs.push(createFog());
    }
    requestAnimationFrame(animateFogs);
  }

  function startFog() {
    if (running) return;
    running = true;
    // Nur im Forest-Theme!
    if (document.body.getAttribute('data-theme') !== 'forest') return;
    // Initial auffüllen
    while (fogs.length < FOG_COUNT) {
      fogs.push(createFog());
    }
    requestAnimationFrame(animateFogs);
  }
  function stopFog() {
    running = false;
    fogs.forEach(fog => fog.remove());
    fogs = [];
  }

  // Theme-Wechsel beobachten
  function handleFogTheme() {
    if (document.body.getAttribute('data-theme') === 'forest') {
      startFog();
    } else {
      stopFog();
    }
  }
  document.addEventListener('DOMContentLoaded', handleFogTheme);
  const origSwitchTheme = window.switchTheme;
  window.switchTheme = function(theme) {
    origSwitchTheme(theme);
    setTimeout(handleFogTheme, 10);
  };
})();
</script>
<!-- ...existing code... -->
</body>
</html>

