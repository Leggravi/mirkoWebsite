---
layout: default
title: Blog
---

<h1>Blog</h1>

<div id="blog-list" class="card-grid">
  {% for post in site.posts %}
    <div class="card blog-item" style="display:none;">
      {% if post.image and post.image != "assets/img/seo.jpg" %}
        <img src="{{ post.image | relative_url }}" alt="{{ post.title }}">
      {% endif %}
      <h2><a href="{{ post.url | relative_url }}">{{ post.title }}</a></h2>
      <small>{{ post.date | date: "%d.%m.%Y" }}</small>
      <p>{{ post.excerpt }}</p>
    </div>
  {% endfor %}
</div>

<div class="pagination">
  <button id="prevBtn" disabled>&laquo; Zurück</button>
  <span id="pageInfo"></span>
  <button id="nextBtn">Weiter &raquo;</button>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    const posts = document.querySelectorAll(".blog-item");
    const perPage = 4; // Anzahl Posts pro Seite
    let currentPage = 1;
    const totalPages = Math.ceil(posts.length / perPage);

    function showPage(page) {
      // Alle verstecken
      posts.forEach(p => p.style.display = "none");

      // Start- und Endindex berechnen
      const start = (page - 1) * perPage;
      const end = start + perPage;

      // Sichtbar machen
      for (let i = start; i < end && i < posts.length; i++) {
        posts[i].style.display = "block";
      }

      // Page Info aktualisieren
      document.getElementById("pageInfo").innerText = "Seite " + page + " von " + totalPages;

      // Buttons aktivieren/deaktivieren
      document.getElementById("prevBtn").disabled = (page === 1);
      document.getElementById("nextBtn").disabled = (page === totalPages);
    }

    // Buttons Events
    document.getElementById("prevBtn").addEventListener("click", function() {
      if (currentPage > 1) {
        currentPage--;
        showPage(currentPage);
      }
    });

    document.getElementById("nextBtn").addEventListener("click", function() {
      if (currentPage < totalPages) {
        currentPage++;
        showPage(currentPage);
      }
    });

    // Erste Seite laden
    showPage(currentPage);
  });
</script>


<hr>
<div id="tagesvers-wrapper">
  <h2 id="tagesvers-title" style="display:none;">Tagesvers</h2>
  <div id="tagesvers-content" aria-live="polite"></div>
</div>

<script>
  // Callback für JSONP
  function showVerse(data) {
    const title = document.getElementById('tagesvers-title');
    const container = document.getElementById('tagesvers-content');

    // Debug: einmalig aktivieren, um zu sehen, wie die API wirklich antwortet:
    // console.log('VOTD data:', data);

    if (!data) {
      title.style.display = 'none';
      container.innerHTML = '';
      return;
    }

    // Mögliche Orte für Text und Referenz (fällt auf mehrere Varianten zurück)
    let text = '';
    let ref  = '';

    if (data.votd) {
      text = data.votd.text || data.votd.html || data.votd.content || data.votd.quote || '';
      ref  = data.votd.scripture || data.votd.reference || data.votd.verse || data.votd.citation || '';
    }

    text = text || data.text || data.html || data.content || '';
    ref  = ref  || data.reference || data.verse || '';

    // Falls text als Objekt kommt (selten), extrahiere html/value
    if (typeof text === 'object' && text !== null) {
      text = text.html || text.value || JSON.stringify(text);
    }

    // Clean / show
    if (text && String(text).trim()) {
      // Wenn es schon HTML ist, übernehmen; sonst Zeilenumbrüche konvertieren
      const isHtml = /<[^>]+>/.test(text);
      container.innerHTML = isHtml ? text : '<p>' + String(text).replace(/\n/g, '<br>') + '</p>';

      // Referenz anfügen, falls vorhanden und nicht bereits im Text
      if (ref && !container.textContent.includes(ref)) {
        const refEl = document.createElement('div');
        refEl.className = 'votd-ref';
        refEl.textContent = ref;
        refEl.style.fontStyle = 'italic';
        refEl.style.marginTop = '0.25rem';
        container.appendChild(refEl);
      }

      title.style.display = 'block';
    } else {
      // Kein Inhalt — nichts anzeigen
      title.style.display = 'none';
      container.innerHTML = '';
    }
  }

  // JSONP-Script nachladen (setzt callback=showVerse)
  const s = document.createElement('script');
  s.src = 'https://www.biblegateway.com/votd/get/?format=json&version=HOF&callback=showVerse';
  document.body.appendChild(s);
</script>
